<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
</head>
<body>
    <h1>QR Code Scanner</h1>
    <video id="qr-video" width="400" height="300" autoplay></video>
    <canvas id="qr-canvas" width="400" height="300"></canvas>
    <div id="qr-result">Kết quả: <span></span></div>

    <script src="https://cdn.rawgit.com/cozmo/jsQR/master/dist/jsQR.js"></script>
    <script>
        const videoElement = document.getElementById('qr-video');
        const canvasElement = document.getElementById('qr-canvas');
        const canvas = canvasElement.getContext('2d');
        const qrResult = document.getElementById('qr-result');

        function startCamera() {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                .then(function (stream) {
                    videoElement.srcObject = stream;
                })
                .catch(function (error) {
                    console.error('Lỗi truy cập camera: ', error);
                });
        }

        videoElement.onloadedmetadata = function (e) {
            canvasElement.style.display = 'none';
            startCamera();
        };

        function scanQRCode() {
            canvasElement.width = videoElement.videoWidth;
            canvasElement.height = videoElement.videoHeight;
            canvas.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height);
            const imageData = canvas.getImageData(0, 0, canvasElement.width, canvasElement.height);
            const code = jsQR(imageData.data, imageData.width, imageData.height);

            if (code) {
                qrResult.textContent = 'Kết quả: ' + code.data;
            } else {
                requestAnimationFrame(scanQRCode);
            }
        }

        startCamera();
        scanQRCode();
    </script>
</body>
</html>

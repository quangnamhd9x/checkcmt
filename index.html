<!DOCTYPE html>
<html>
<head>
    <title>Đọc mã QR từ Camera</title>
</head>
<body>
    <video id="qr-video" autoplay playsinline style="width: 100%; height: auto;"></video>
    <canvas id="qr-canvas" style="display: none;"></canvas>
    <div id="qr-result">Kết quả sẽ được hiển thị ở đây.</div>
    
    <script src="https://rawgit.com/cozmo/jsQR/master/dist/jsQR.js"></script>
    <script>
        // Bắt đầu camera
        async function startCamera() {
            const constraints = {
                video: { facingMode: 'environment' }
            };
            const stream = await navigator.mediaDevices.getUserMedia(constraints);
            const video = document.getElementById('qr-video');
            video.srcObject = stream;
        }

        // Đọc mã QR từ hình ảnh
        async function decodeQRCode() {
            const video = document.getElementById('qr-video');
            const canvas = document.getElementById('qr-canvas');
            const context = canvas.getContext('2d');

            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
            const code = jsQR(imageData.data, imageData.width, imageData.height);

            if (code) {
                document.getElementById('qr-result').textContent = 'QR Code: ' + code.data;
            } else {
                requestAnimationFrame(decodeQRCode);
            }
        }

        // Bắt đầu camera và quét mã QR
        startCamera().then(() => {
            requestAnimationFrame(decodeQRCode);
        });
    </script>
</body>
</html>
